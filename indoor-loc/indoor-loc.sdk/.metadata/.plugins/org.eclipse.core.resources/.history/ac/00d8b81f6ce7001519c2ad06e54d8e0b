/*
 * uwb.h:UWB Control
 *
 *  Created on: Mar 11, 2016
 *      Author: rupprich
 */

#ifndef UWB_H_
#define UWB_H_

// Includes
#include <stdio.h>
#include "xparameters.h"
#include "xgpio.h"
#include "decadriver/deca_device_api.h"
#include "decadriver/deca_regs.h"
#include "deca/deca_sleep.h"
#include "deca/deca_spi.h"
#include "deca/port.h"
#include "../zedboard/print_utils.h"

//Structs
/* Default communication configuration. Use channel 5 in this example as it is the recommended channel for crystal trimming operation. */
static dwt_config_t config = {
    5,               /* Channel number. */
    DWT_PRF_64M,     /* Pulse repetition frequency. */
    DWT_PLEN_1024,   /* Preamble length. */
    DWT_PAC32,       /* Preamble acquisition chunk size. Used in RX only. */
    9,               /* TX preamble code. Used in TX only. */
    9,               /* RX preamble code. Used in RX only. */
    1,               /* Use non-standard SFD (Boolean) */
    DWT_BR_110K,     /* Data rate. */
    DWT_PHRMODE_STD, /* PHY header mode. */
    (1025 + 64 - 32) /* SFD timeout (preamble length + 1 + SFD length - PAC size). Used in RX only. */
};

/* Recommended TX power and Pulse Generator delay values for the mode defined above. */
static dwt_txconfig_t txconfig = {
    0xC0,            /* PG delay. */
    0x25456585,      /* TX power. */
};

/*
 * Functions
 */
/*
 * Function Prototypes
 */
int ssTwrInit(void);
int ssTwrResp(void);
int txWait(void);
int rxWait(void);
int simpleTx(void);
int simpleRx(void);
void reset_DW1000();


#endif /* UWB_H_ */
